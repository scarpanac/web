<html>
<body>

<form  method="post">
    <input type='text' name="name" placeholder="Type Search" />
    <input type="submit" name="go" value="Search" />
</form>
</form>
</body>
</html>

<?php

# [START bigquery_simple_app_all]
require __DIR__ . '/vendor/autoload.php';

# [START bigquery_simple_app_deps]
use Google\Cloud\BigQuery\BigQueryClient;

# [END bigquery_simple_app_deps]

// get the project ID as the first argument

// if (2 != count($argv)) {
//     die("Usage: php stackoverflow.php lfanttest1\n");
// }

$projectId = $argv[1];

# [START bigquery_simple_app_client]
$bigQuery = new BigQueryClient([
    'lfanttest1' => $projectId,
]);
# [END bigquery_simple_app_client]
# [START bigquery_simple_app_query]
$query = <<<ENDSQL

SELECT id, title, date_time, location, price, images
FROM `lfanttest1.items.items`
ORDER BY id ASC
LIMIT 1000;

ENDSQL;
$queryJobConfig = $bigQuery->query($query);
$queryResults = $bigQuery->runQuery($queryJobConfig);

# [END bigquery_simple_app_query]


# [START bigquery_simple_app_print]
if ($queryResults->isComplete()) {
    $i = 0;
    $rows = $queryResults->rows();
    print '<table border=1><tr><th>id</th><th>title</th><th>date_time</th><th>location</th><th>price</th><th>images</th></tr>';
    foreach ($rows as $row) {
        #foreach ($row as $column => $value) {
        foreach ($row as $column => $value) {
            // echo($row);
            // print_r($row);
            $arr = array($row);
            #print_r($arr);
            #print '<table border=1><tr><th>id</th><th>title</th><th>date_time</th><th>location</th><th>price</th><th>images</th></tr>';
            foreach ($arr as $value) {
            #echo "<td>" . $theCurrentRow["id"] . "</td><td>" . $theCurrentRow["title"] . "</td><td>" . "</td>";
            echo "<tr><td>".$value["id"]."</td><td>".$value["title"]."</td><td>".$value["date_time"]."</td><td>".$value["location"]."</td><td>".$value["price"].'</td><td><img src="'.$value["images"].'" height="100" width="100"></td>';
            
            }
            #print '</table>';

        }
    }
    print '</table>';
    //printf('Found %s row(s)' . PHP_EOL, $i);
    
} else {
    throw new Exception('The query failed to complete');
}
# [END bigquery_simple_app_print]
# [END bigquery_simple_app_all]

?>
